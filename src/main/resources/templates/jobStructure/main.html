<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
  <script>
    tailwind.config = {
        darkMode: "class",
        theme: {
            extend: {
                colors: {
                    primary: {
                        50: '#eff6ff',
                        100: '#dbeafe',
                        200: '#bfdbfe',
                        300: '#93c5fd',
                        400: '#60a5fa',
                        500: '#3b82f6',
                        600: '#2563eb',
                        700: '#1d4ed8',
                        800: '#1e40af',
                        900: '#1e3a8a',
                    },
                    secondary: {
                        50: '#f8fafc',
                        100: '#f1f5f9',
                        200: '#e2e8f0',
                        300: '#cbd5e1',
                        400: '#94a3b8',
                        500: '#64748b',
                        600: '#475569',
                        700: '#334155',
                        800: '#1e293b',
                        900: '#0f172a',
                    }
                },
                fontFamily: {
                    'sans': ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
                },
                borderRadius: {
                    'xl': '1rem',
                    '2xl': '1.5rem',
                }
            },
        },
    };
  </script>
  <style>
    * {
        font-family: 'Inter', sans-serif;
    }

    body {
        overflow-x: hidden;
    }

    .sidebar-item {
        transition: all 0.2s ease;
        position: relative;
    }

    .sidebar-item.active {
        background-color: rgba(59, 130, 246, 0.1);
        color: #3b82f6;
        border-left: 3px solid #3b82f6;
    }

    .sidebar-item.active .material-icons-round {
        color: #3b82f6;
    }

    .sidebar-item:hover:not(.active) {
        background-color: rgba(59, 130, 246, 0.05);
    }

    .dark .sidebar-item.active {
        background-color: rgba(59, 130, 246, 0.2);
    }

    .stat-card {
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
    }

    .badge {
        padding: 2px 8px;
        font-size: 0.75rem;
        font-weight: 500;
        border-radius: 9999px;
    }

    .badge-success {
        background-color: #dcfce7;
        color: #16a34a;
    }

    .badge-warning {
        background-color: #fef3c7;
        color: #d97706;
    }

    .badge-error {
        background-color: #fee2e2;
        color: #dc2626;
    }

    .badge-info {
        background-color: #dbeafe;
        color: #2563eb;
    }

    .progress-bar {
        height: 8px;
        border-radius: 4px;
        overflow: hidden;
        background-color: #e5e7eb;
    }

    .dark .progress-bar {
        background-color: #374151;
    }

    .progress-fill {
        height: 100%;
        border-radius: 4px;
    }

    .sidebar-scroll::-webkit-scrollbar {
        width: 4px;
    }

    .sidebar-scroll::-webkit-scrollbar-track {
        background: transparent;
    }

    .sidebar-scroll::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
    }

    .dark .sidebar-scroll::-webkit-scrollbar-thumb {
        background: #4b5563;
    }

    .transition-all {
        transition-property: all;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        transition-duration: 200ms;
    }

    .sidebar-container {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: 16rem;
        z-index: 40;
        overflow-y: auto;
    }

    .main-content {
        margin-left: 16rem;
        width: calc(100% - 16rem);
        min-height: 100vh;
    }

    @media (max-width: 1023px) {
        .sidebar-container {
            transform: translateX(-100%);
        }

        .sidebar-container.open {
            transform: translateX(0);
        }

        .main-content {
            margin-left: 0;
            width: 100%;
        }
    }

    .grade-color-1 { background-color: #3b82f6; }
    .grade-color-2 { background-color: #10b981; }
    .grade-color-3 { background-color: #8b5cf6; }
    .grade-color-4 { background-color: #f59e0b; }
    .grade-color-5 { background-color: #ef4444; }
    .grade-color-6 { background-color: #06b6d4; }
    .grade-color-7 { background-color: #ec4899; }

    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
    }

    .modal.active {
        display: flex;
    }

    .modal-content {
        background: white;
        border-radius: 12px;
        width: 90%;
        max-width: 500px;
        max-height: 90vh;
        overflow-y: auto;
    }

    .dark .modal-content {
        background: #1f2937;
    }

    .step-level-indicator {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        color: white;
    }

    .salary-progression-bar {
        height: 4px;
        background: linear-gradient(90deg, #3b82f6, #10b981, #8b5cf6, #f59e0b);
        border-radius: 2px;
        margin: 8px 0;
    }
  </style>
</head>
<body>
<main layout:fragment="content">
  <!-- Stats Cards -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-6 md:mb-8">
    <!-- Total Grades -->
    <div class="stat-card bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 md:p-6">
      <div class="flex items-center justify-between mb-4">
        <div class="p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg">
          <span class="material-icons-round text-blue-600 dark:text-blue-400">layers</span>
        </div>
      </div>
      <h3 class="text-2xl font-bold mb-1" id="totalGrades">7</h3>
      <p class="text-gray-600 dark:text-gray-400 text-sm">Job Grades</p>
      <div class="mt-3 flex items-center text-xs text-gray-500">
        <span class="material-icons-round text-xs mr-1">check_circle</span>
        <span>From Grade 1 to Grade 7</span>
      </div>
    </div>

    <!-- Total Steps -->
    <div class="stat-card bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 md:p-6">
      <div class="flex items-center justify-between mb-4">
        <div class="p-3 bg-green-100 dark:bg-green-900/30 rounded-lg">
          <span class="material-icons-round text-green-600 dark:text-green-400">stairs</span>
        </div>
      </div>
      <h3 class="text-2xl font-bold mb-1" id="totalSteps">35</h3>
      <p class="text-gray-600 dark:text-gray-400 text-sm">Job Steps</p>
      <div class="mt-3 flex items-center text-xs text-gray-500">
        <span class="material-icons-round text-xs mr-1">timeline</span>
        <span>5 steps per grade average</span>
      </div>
    </div>

    <!-- Avg Salary Range -->
    <div class="stat-card bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 md:p-6">
      <div class="flex items-center justify-between mb-4">
        <div class="p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg">
          <span class="material-icons-round text-purple-600 dark:text-purple-400">attach_money</span>
        </div>
      </div>
      <h3 class="text-2xl font-bold mb-1">$2,500</h3>
      <p class="text-gray-600 dark:text-gray-400 text-sm">Avg Step Increase</p>
      <div class="mt-3">
        <div class="progress-bar">
          <div class="progress-fill bg-purple-500" style="width: 75%"></div>
        </div>
        <p class="text-xs text-gray-500 mt-1">Consistent progression</p>
      </div>
    </div>

    <!-- Employees by Grade -->
    <div class="stat-card bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 md:p-6">
      <div class="flex items-center justify-between mb-4">
        <div class="p-3 bg-orange-100 dark:bg-orange-900/30 rounded-lg">
          <span class="material-icons-round text-orange-600 dark:text-orange-400">people</span>
        </div>
        <span class="badge badge-info">Distribution</span>
      </div>
      <h3 class="text-2xl font-bold mb-1">1,248</h3>
      <p class="text-gray-600 dark:text-gray-400 text-sm">Employees Mapped</p>
      <div class="mt-3 flex items-center text-xs text-gray-500">
        <span class="material-icons-round text-xs mr-1">pie_chart</span>
        <span>All employees assigned to grades</span>
      </div>
    </div>
  </div>

  <!-- Two Column Layout -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6 mb-6 md:mb-8">
    <!-- Left Column - Job Grades List -->
    <div class="lg:col-span-2 space-y-4 md:space-y-6">
      <!-- Job Grades Management -->
      <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700">
        <div class="p-4 md:p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <span class="material-icons-round text-primary-600">layers</span>
              <h3 class="text-lg font-bold">Job Grades</h3>
            </div>
            <button onclick="openModal('addGradeModal')" class="flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg text-sm font-medium hover:bg-primary-700">
              <span class="material-icons-round text-sm">add</span>
              <span>Add Grade</span>
            </button>
          </div>
        </div>

        <div class="p-4 md:p-6">
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="gradesList">
            <!-- Grades will be loaded here dynamically -->
          </div>
        </div>
      </div>

      <!-- Salary Progression Chart -->
      <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700">
        <div class="p-4 md:p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <span class="material-icons-round text-primary-600">show_chart</span>
              <h3 class="text-lg font-bold">Salary Progression Analysis</h3>
            </div>
            <select id="chartGradeSelect" class="px-3 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-sm">
              <option value="all">All Grades</option>
              <option value="1">Grade 1</option>
              <option value="2">Grade 2</option>
              <option value="3">Grade 3</option>
              <option value="4">Grade 4</option>
              <option value="5">Grade 5</option>
              <option value="6">Grade 6</option>
              <option value="7">Grade 7</option>
            </select>
          </div>
        </div>

        <div class="p-4 md:p-6">
          <div class="h-64">
            <canvas id="salaryChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column - Selected Grade Details -->
    <div class="space-y-4 md:space-y-6">
      <!-- Selected Grade Details -->
      <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700" id="gradeDetails">
        <div class="p-4 md:p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-bold">Grade Details</h3>
            <span class="text-sm text-gray-500">Select a grade</span>
          </div>
        </div>

        <div class="p-4 md:p-6">
          <div class="text-center py-8">
            <span class="material-icons-round text-gray-400 text-4xl mb-4">layers</span>
            <p class="text-gray-500 dark:text-gray-400">Select a job grade to view details</p>
          </div>
        </div>
      </div>

      <!-- Grade Statistics -->
      <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700">
        <div class="p-4 md:p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-bold">Grade Statistics</h3>
          </div>
        </div>

        <div class="p-4 md:p-6">
          <div class="space-y-4">
            <div>
              <div class="flex justify-between mb-1">
                <span class="text-sm text-gray-600 dark:text-gray-400">Grade Distribution</span>
                <span class="text-sm font-medium">100%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill bg-blue-500" style="width: 100%"></div>
              </div>
            </div>

            <div>
              <div class="flex justify-between mb-1">
                <span class="text-sm text-gray-600 dark:text-gray-400">Average Steps per Grade</span>
                <span class="text-sm font-medium">5.0</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill bg-green-500" style="width: 100%"></div>
              </div>
            </div>

            <div>
              <div class="flex justify-between mb-1">
                <span class="text-sm text-gray-600 dark:text-gray-400">Salary Range Coverage</span>
                <span class="text-sm font-medium">$1,500 - $15,000</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill bg-purple-500" style="width: 90%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Steps Table -->
  <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 mb-6 md:mb-8">
    <div class="p-4 md:p-6 border-b border-gray-200 dark:border-gray-700">
      <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
        <div class="flex items-center space-x-3">
          <span class="material-icons-round text-primary-600">stairs</span>
          <h3 class="text-lg font-bold">Job Steps</h3>
          <span class="text-sm text-gray-500">(Select a grade to filter steps)</span>
        </div>
        <div class="flex items-center space-x-3">
          <select id="gradeFilter" class="px-3 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-sm">
            <option value="all">All Grades</option>
            <option value="1">Grade 1</option>
            <option value="2">Grade 2</option>
            <option value="3">Grade 3</option>
            <option value="4">Grade 4</option>
            <option value="5">Grade 5</option>
            <option value="6">Grade 6</option>
            <option value="7">Grade 7</option>
          </select>
          <button onclick="openModal('addStepModal')" class="flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg text-sm font-medium hover:bg-primary-700">
            <span class="material-icons-round text-sm">add</span>
            <span>Add Step</span>
          </button>
        </div>
      </div>
    </div>

    <div class="overflow-x-auto">
      <table class="w-full">
        <thead>
        <tr class="bg-gray-50 dark:bg-gray-750">
          <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Grade</th>
          <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Step Level</th>
          <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Base Salary</th>
          <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Employees</th>
          <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
        </tr>
        </thead>
        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="stepsTableBody">
        <!-- Steps will be loaded here dynamically -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Add Grade Modal -->
  <div id="addGradeModal" class="modal">
    <div class="modal-content">
      <div class="p-6 border-b border-gray-200 dark:border-gray-700">
        <h3 class="text-xl font-bold">Add New Job Grade</h3>
      </div>

      <div class="p-6">
        <form id="addGradeForm">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium mb-2">Grade Code *</label>
              <input type="text"
                     required
                     class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                     placeholder="e.g., GRD-001"
                     name="code">
              <p class="text-xs text-gray-500 mt-1">Unique identifier for the grade</p>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">Grade Name *</label>
              <input type="text"
                     required
                     class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                     placeholder="e.g., Junior Associate"
                     name="name">
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">Grade Level</label>
              <input type="number"
                     min="1"
                     max="10"
                     class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                     placeholder="1-10"
                     name="level">
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">Description</label>
              <textarea
                      class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                      rows="3"
                      placeholder="Description of this job grade..."
                      name="description"></textarea>
            </div>
          </div>

          <div class="flex justify-end space-x-3 mt-6">
            <button type="button" onclick="closeModal('addGradeModal')" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-700">
              Cancel
            </button>
            <button type="submit" class="px-4 py-2 bg-primary-600 text-white rounded-lg text-sm font-medium hover:bg-primary-700">
              Add Grade
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Add Step Modal -->
  <div id="addStepModal" class="modal">
    <div class="modal-content">
      <div class="p-6 border-b border-gray-200 dark:border-gray-700">
        <h3 class="text-xl font-bold">Add New Job Step</h3>
      </div>

      <div class="p-6">
        <form id="addStepForm">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium mb-2">Job Grade *</label>
              <select required
                      class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                      name="gradeId">
                <option value="">Select a grade</option>
                <option value="1">Grade 1 - Entry Level</option>
                <option value="2">Grade 2 - Associate</option>
                <option value="3">Grade 3 - Senior Associate</option>
                <option value="4">Grade 4 - Team Lead</option>
                <option value="5">Grade 5 - Manager</option>
                <option value="6">Grade 6 - Senior Manager</option>
                <option value="7">Grade 7 - Director</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">Step Level *</label>
              <input type="number"
                     required
                     min="1"
                     max="10"
                     class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                     placeholder="1-10"
                     name="stepLevel">
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">Base Salary *</label>
              <div class="relative">
                <span class="absolute left-3 top-1/2 transform -translate-y-1/2">$</span>
                <input type="number"
                       required
                       min="0"
                       step="0.01"
                       class="w-full pl-8 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                       placeholder="0.00"
                       name="baseSalary">
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">Description</label>
              <textarea
                      class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                      rows="3"
                      placeholder="Additional information about this step..."
                      name="description"></textarea>
            </div>
          </div>

          <div class="flex justify-end space-x-3 mt-6">
            <button type="button" onclick="closeModal('addStepModal')" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-700">
              Cancel
            </button>
            <button type="submit" class="px-4 py-2 bg-primary-600 text-white rounded-lg text-sm font-medium hover:bg-primary-700">
              Add Step
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Edit Grade Modal -->
  <div id="editGradeModal" class="modal">
    <div class="modal-content">
      <div class="p-6 border-b border-gray-200 dark:border-gray-700">
        <h3 class="text-xl font-bold">Edit Job Grade</h3>
      </div>

      <div class="p-6">
        <form id="editGradeForm">
          <input type="hidden" name="id" id="editGradeId">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium mb-2">Grade Code *</label>
              <input type="text"
                     required
                     id="editGradeCode"
                     class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                     name="code">
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">Grade Name *</label>
              <input type="text"
                     required
                     id="editGradeName"
                     class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                     name="name">
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">Description</label>
              <textarea
                      id="editGradeDescription"
                      class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 focus:outline-none"
                      rows="3"
                      name="description"></textarea>
            </div>
          </div>

          <div class="flex justify-end space-x-3 mt-6">
            <button type="button" onclick="closeModal('editGradeModal')" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-700">
              Cancel
            </button>
            <button type="submit" class="px-4 py-2 bg-primary-600 text-white rounded-lg text-sm font-medium hover:bg-primary-700">
              Update Grade
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Sample data - In a real application, this would come from an API
    const jobGrades = [
        { id: 1, code: 'GRD-001', name: 'Entry Level', level: 1, description: 'Entry level positions', employees: 150 },
        { id: 2, code: 'GRD-002', name: 'Associate', level: 2, description: 'Junior associate roles', employees: 280 },
        { id: 3, code: 'GRD-003', name: 'Senior Associate', level: 3, description: 'Experienced individual contributors', employees: 320 },
        { id: 4, code: 'GRD-004', name: 'Team Lead', level: 4, description: 'Team leadership positions', employees: 180 },
        { id: 5, code: 'GRD-005', name: 'Manager', level: 5, description: 'Department managers', employees: 150 },
        { id: 6, code: 'GRD-006', name: 'Senior Manager', level: 6, description: 'Senior management roles', employees: 90 },
        { id: 7, code: 'GRD-007', name: 'Director', level: 7, description: 'Executive leadership', employees: 78 }
    ];

    const jobSteps = [
        { id: 1, gradeId: 1, stepLevel: 1, baseSalary: 1500.00, employees: 50 },
        { id: 2, gradeId: 1, stepLevel: 2, baseSalary: 1800.00, employees: 45 },
        { id: 3, gradeId: 1, stepLevel: 3, baseSalary: 2100.00, employees: 35 },
        { id: 4, gradeId: 1, stepLevel: 4, baseSalary: 2400.00, employees: 15 },
        { id: 5, gradeId: 1, stepLevel: 5, baseSalary: 2700.00, employees: 5 },
        { id: 6, gradeId: 2, stepLevel: 1, baseSalary: 2800.00, employees: 80 },
        { id: 7, gradeId: 2, stepLevel: 2, baseSalary: 3200.00, employees: 75 },
        { id: 8, gradeId: 2, stepLevel: 3, baseSalary: 3600.00, employees: 65 },
        { id: 9, gradeId: 2, stepLevel: 4, baseSalary: 4000.00, employees: 40 },
        { id: 10, gradeId: 2, stepLevel: 5, baseSalary: 4400.00, employees: 20 },
        { id: 11, gradeId: 3, stepLevel: 1, baseSalary: 4500.00, employees: 90 },
        { id: 12, gradeId: 3, stepLevel: 2, baseSalary: 5000.00, employees: 85 },
        { id: 13, gradeId: 3, stepLevel: 3, baseSalary: 5500.00, employees: 75 },
        { id: 14, gradeId: 3, stepLevel: 4, baseSalary: 6000.00, employees: 50 },
        { id: 15, gradeId: 3, stepLevel: 5, baseSalary: 6500.00, employees: 20 },
        { id: 16, gradeId: 4, stepLevel: 1, baseSalary: 7000.00, employees: 60 },
        { id: 17, gradeId: 4, stepLevel: 2, baseSalary: 7500.00, employees: 50 },
        { id: 18, gradeId: 4, stepLevel: 3, baseSalary: 8000.00, employees: 40 },
        { id: 19, gradeId: 4, stepLevel: 4, baseSalary: 8500.00, employees: 20 },
        { id: 20, gradeId: 4, stepLevel: 5, baseSalary: 9000.00, employees: 10 },
        { id: 21, gradeId: 5, stepLevel: 1, baseSalary: 9500.00, employees: 50 },
        { id: 22, gradeId: 5, stepLevel: 2, baseSalary: 10000.00, employees: 40 },
        { id: 23, gradeId: 5, stepLevel: 3, baseSalary: 10500.00, employees: 35 },
        { id: 24, gradeId: 5, stepLevel: 4, baseSalary: 11000.00, employees: 15 },
        { id: 25, gradeId: 5, stepLevel: 5, baseSalary: 11500.00, employees: 10 },
        { id: 26, gradeId: 6, stepLevel: 1, baseSalary: 12000.00, employees: 30 },
        { id: 27, gradeId: 6, stepLevel: 2, baseSalary: 12500.00, employees: 25 },
        { id: 28, gradeId: 6, stepLevel: 3, baseSalary: 13000.00, employees: 20 },
        { id: 29, gradeId: 6, stepLevel: 4, baseSalary: 13500.00, employees: 10 },
        { id: 30, gradeId: 6, stepLevel: 5, baseSalary: 14000.00, employees: 5 },
        { id: 31, gradeId: 7, stepLevel: 1, baseSalary: 14500.00, employees: 25 },
        { id: 32, gradeId: 7, stepLevel: 2, baseSalary: 15000.00, employees: 20 },
        { id: 33, gradeId: 7, stepLevel: 3, baseSalary: 15500.00, employees: 18 },
        { id: 34, gradeId: 7, stepLevel: 4, baseSalary: 16000.00, employees: 10 },
        { id: 35, gradeId: 7, stepLevel: 5, baseSalary: 16500.00, employees: 5 }
    ];

    let selectedGradeId = null;
    let salaryChart = null;

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
        loadGrades();
        loadSteps();
        initializeChart();

        // Set up event listeners
        document.getElementById('searchInput').addEventListener('input', filterData);
        document.getElementById('gradeFilter').addEventListener('change', loadSteps);
        document.getElementById('chartGradeSelect').addEventListener('change', updateChart);

        // Form submissions
        document.getElementById('addGradeForm').addEventListener('submit', addGrade);
        document.getElementById('addStepForm').addEventListener('submit', addStep);
        document.getElementById('editGradeForm').addEventListener('submit', updateGrade);

        // Initialize theme
        initializeTheme();

        // Update stats
        updateStats();
    });

    function loadGrades() {
        const container = document.getElementById('gradesList');
        container.innerHTML = '';

        jobGrades.forEach(grade => {
            const gradeElement = document.createElement('div');
            gradeElement.className = 'border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:border-primary-500 transition-colors cursor-pointer';
            gradeElement.onclick = () => selectGrade(grade.id);

            if (selectedGradeId === grade.id) {
                gradeElement.classList.add('ring-2', 'ring-primary-500');
            }

            const colorClass = `grade-color-${grade.level}`;

            gradeElement.innerHTML = `
                <div class="flex items-start justify-between mb-3">
                    <div class="flex items-center space-x-3">
                        <div class="step-level-indicator ${colorClass}">${grade.level}</div>
                        <div>
                            <h4 class="font-bold text-lg">${grade.name}</h4>
                            <p class="text-sm text-gray-500">${grade.code}</p>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="event.stopPropagation(); editGrade(${grade.id})" class="p-1 text-gray-400 hover:text-primary-600">
                            <span class="material-icons-round text-sm">edit</span>
                        </button>
                        <button onclick="event.stopPropagation(); deleteGrade(${grade.id})" class="p-1 text-gray-400 hover:text-red-600">
                            <span class="material-icons-round text-sm">delete</span>
                        </button>
                    </div>
                </div>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">${grade.description}</p>
                <div class="flex items-center justify-between">
                    <span class="text-sm font-medium">${grade.employees} Employees</span>
                    <span class="text-sm text-gray-500">${getStepsForGrade(grade.id).length} Steps</span>
                </div>
            `;

            container.appendChild(gradeElement);
        });
    }

    function loadSteps() {
        const tbody = document.getElementById('stepsTableBody');
        const gradeFilter = document.getElementById('gradeFilter').value;

        tbody.innerHTML = '';

        const filteredSteps = gradeFilter === 'all'
            ? jobSteps
            : jobSteps.filter(step => step.gradeId == gradeFilter);

        filteredSteps.forEach(step => {
            const grade = jobGrades.find(g => g.id === step.gradeId);
            const row = document.createElement('tr');

            row.innerHTML = `
                <td class="px-4 md:px-6 py-4">
                    <div class="flex items-center space-x-3">
                        <div class="step-level-indicator grade-color-${grade.level}">${grade.level}</div>
                        <div>
                            <span class="font-medium">${grade.name}</span>
                            <p class="text-xs text-gray-500">${grade.code}</p>
                        </div>
                    </div>
                </td>
                <td class="px-4 md:px-6 py-4">
                    <div class="flex items-center space-x-2">
                        <span class="font-bold text-lg">${step.stepLevel}</span>
                        <span class="text-xs text-gray-500">/ 5</span>
                    </div>
                </td>
                <td class="px-4 md:px-6 py-4">
                    <span class="font-bold">$${step.baseSalary.toFixed(2)}</span>
                    <p class="text-xs text-gray-500">Monthly</p>
                </td>
                <td class="px-4 md:px-6 py-4">
                    <span class="font-medium">${step.employees}</span>
                    <p class="text-xs text-gray-500">Employees</p>
                </td>
                <td class="px-4 md:px-6 py-4">
                    <div class="flex space-x-2">
                        <button onclick="editStep(${step.id})" class="p-1 text-gray-400 hover:text-primary-600">
                            <span class="material-icons-round text-sm">edit</span>
                        </button>
                        <button onclick="deleteStep(${step.id})" class="p-1 text-gray-400 hover:text-red-600">
                            <span class="material-icons-round text-sm">delete</span>
                        </button>
                    </div>
                </td>
            `;

            tbody.appendChild(row);
        });
    }

    function selectGrade(gradeId) {
        selectedGradeId = gradeId;
        loadGrades();
        loadGradeDetails(gradeId);
        document.getElementById('gradeFilter').value = gradeId;
        loadSteps();
        updateChart();
    }

    function loadGradeDetails(gradeId) {
        const grade = jobGrades.find(g => g.id === gradeId);
        const container = document.getElementById('gradeDetails');

        if (!grade) return;

        const steps = getStepsForGrade(gradeId);
        const minSalary = Math.min(...steps.map(s => s.baseSalary));
        const maxSalary = Math.max(...steps.map(s => s.baseSalary));
        const avgSalary = steps.reduce((sum, s) => sum + s.baseSalary, 0) / steps.length;

        container.innerHTML = `
            <div class="p-4 md:p-6 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg font-bold">${grade.name}</h3>
                    <div class="flex space-x-2">
                        <button onclick="editGrade(${grade.id})" class="p-2 text-gray-400 hover:text-primary-600">
                            <span class="material-icons-round text-sm">edit</span>
                        </button>
                        <button onclick="deleteGrade(${grade.id})" class="p-2 text-gray-400 hover:text-red-600">
                            <span class="material-icons-round text-sm">delete</span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="p-4 md:p-6">
                <div class="mb-6">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="step-level-indicator grade-color-${grade.level}">${grade.level}</div>
                        <div>
                            <h4 class="font-bold text-xl">${grade.name}</h4>
                            <p class="text-sm text-gray-500">${grade.code}</p>
                        </div>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">${grade.description}</p>
                </div>

                <div class="space-y-4">
                    <div class="p-3 bg-gray-50 dark:bg-gray-750 rounded-lg">
                        <div class="flex justify-between mb-2">
                            <span class="text-sm text-gray-600">Total Employees</span>
                            <span class="font-bold">${grade.employees}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill bg-blue-500" style="width: ${(grade.employees / 1248 * 100)}%"></div>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-750 rounded-lg">
                        <div class="flex justify-between mb-2">
                            <span class="text-sm text-gray-600">Salary Range</span>
                            <span class="font-bold">$${minSalary.toFixed(0)} - $${maxSalary.toFixed(0)}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill bg-green-500" style="width: 100%"></div>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-750 rounded-lg">
                        <div class="flex justify-between mb-2">
                            <span class="text-sm text-gray-600">Average Salary</span>
                            <span class="font-bold">$${avgSalary.toFixed(2)}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill bg-purple-500" style="width: ${(avgSalary / 16500 * 100)}%"></div>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-750 rounded-lg">
                        <div class="flex justify-between mb-2">
                            <span class="text-sm text-gray-600">Total Steps</span>
                            <span class="font-bold">${steps.length}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill bg-orange-500" style="width: ${(steps.length / 5 * 100)}%"></div>
                        </div>
                    </div>
                </div>

                <div class="mt-6">
                    <h5 class="font-medium mb-3">Step Progression</h5>
                    <div class="space-y-2">
                        ${steps.map(step => `
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Step ${step.stepLevel}</span>
                                <span class="font-medium">$${step.baseSalary.toFixed(2)}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="salary-progression-bar"></div>
                </div>
            </div>
        `;
    }

    function getStepsForGrade(gradeId) {
        return jobSteps.filter(step => step.gradeId === gradeId);
    }

    function initializeChart() {
        const ctx = document.getElementById('salaryChart').getContext('2d');

        const data = {
            labels: jobGrades.map(g => g.name),
            datasets: [{
                label: 'Minimum Salary',
                data: jobGrades.map(g => Math.min(...getStepsForGrade(g.id).map(s => s.baseSalary))),
                borderColor: '#3b82f6',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                tension: 0.4
            }, {
                label: 'Maximum Salary',
                data: jobGrades.map(g => Math.max(...getStepsForGrade(g.id).map(s => s.baseSalary))),
                borderColor: '#10b981',
                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                tension: 0.4
            }]
        };

        salaryChart = new Chart(ctx, {
            type: 'line',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.dataset.label}: $${context.raw.toFixed(2)}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '$' + value.toFixed(0);
                            }
                        }
                    }
                }
            }
        });
    }

    function updateChart() {
        const selectedGrade = document.getElementById('chartGradeSelect').value;

        if (selectedGrade === 'all') {
            salaryChart.data.labels = jobGrades.map(g => g.name);
            salaryChart.data.datasets[0].data = jobGrades.map(g => Math.min(...getStepsForGrade(g.id).map(s => s.baseSalary)));
            salaryChart.data.datasets[1].data = jobGrades.map(g => Math.max(...getStepsForGrade(g.id).map(s => s.baseSalary)));
        } else {
            const grade = jobGrades.find(g => g.id == selectedGrade);
            const steps = getStepsForGrade(parseInt(selectedGrade));

            salaryChart.data.labels = steps.map(s => `Step ${s.stepLevel}`);
            salaryChart.data.datasets[0].data = steps.map(s => s.baseSalary);
            salaryChart.data.datasets[1].data = [];
        }

        salaryChart.update();
    }

    function addGrade(e) {
        e.preventDefault();
        const formData = new FormData(e.target);

        const newGrade = {
            id: jobGrades.length + 1,
            code: formData.get('code'),
            name: formData.get('name'),
            level: parseInt(formData.get('level')) || 1,
            description: formData.get('description'),
            employees: 0
        };

        jobGrades.push(newGrade);
        closeModal('addGradeModal');
        loadGrades();
        updateStats();
        showNotification('Job grade added successfully!', 'success');
    }

    function addStep(e) {
        e.preventDefault();
        const formData = new FormData(e.target);

        const newStep = {
            id: jobSteps.length + 1,
            gradeId: parseInt(formData.get('gradeId')),
            stepLevel: parseInt(formData.get('stepLevel')),
            baseSalary: parseFloat(formData.get('baseSalary')),
            employees: 0
        };

        jobSteps.push(newStep);
        closeModal('addStepModal');
        loadSteps();
        updateStats();

        if (selectedGradeId === newStep.gradeId) {
            loadGradeDetails(selectedGradeId);
        }

        showNotification('Job step added successfully!', 'success');
    }

    function editGrade(gradeId) {
        const grade = jobGrades.find(g => g.id === gradeId);
        if (!grade) return;

        document.getElementById('editGradeId').value = grade.id;
        document.getElementById('editGradeCode').value = grade.code;
        document.getElementById('editGradeName').value = grade.name;
        document.getElementById('editGradeDescription').value = grade.description || '';

        openModal('editGradeModal');
    }

    function updateGrade(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const gradeId = parseInt(formData.get('id'));

        const gradeIndex = jobGrades.findIndex(g => g.id === gradeId);
        if (gradeIndex !== -1) {
            jobGrades[gradeIndex].code = formData.get('code');
            jobGrades[gradeIndex].name = formData.get('name');
            jobGrades[gradeIndex].description = formData.get('description');

            closeModal('editGradeModal');
            loadGrades();

            if (selectedGradeId === gradeId) {
                loadGradeDetails(gradeId);
            }

            showNotification('Job grade updated successfully!', 'success');
        }
    }

    function deleteGrade(gradeId) {
        if (confirm('Are you sure you want to delete this job grade? This will also delete all associated steps.')) {
            const gradeIndex = jobGrades.findIndex(g => g.id === gradeId);
            if (gradeIndex !== -1) {
                jobGrades.splice(gradeIndex, 1);
                jobSteps = jobSteps.filter(s => s.gradeId !== gradeId);

                loadGrades();
                loadSteps();
                updateStats();

                if (selectedGradeId === gradeId) {
                    selectedGradeId = null;
                    document.getElementById('gradeDetails').innerHTML = `
                        <div class="p-4 md:p-6 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-bold">Grade Details</h3>
                                <span class="text-sm text-gray-500">Select a grade</span>
                            </div>
                        </div>
                        <div class="p-4 md:p-6">
                            <div class="text-center py-8">
                                <span class="material-icons-round text-gray-400 text-4xl mb-4">layers</span>
                                <p class="text-gray-500 dark:text-gray-400">Select a job grade to view details</p>
                            </div>
                        </div>
                    `;
                }

                showNotification('Job grade deleted successfully!', 'success');
            }
        }
    }

    function deleteStep(stepId) {
        if (confirm('Are you sure you want to delete this job step?')) {
            const stepIndex = jobSteps.findIndex(s => s.id === stepId);
            if (stepIndex !== -1) {
                jobSteps.splice(stepIndex, 1);
                loadSteps();
                updateStats();

                if (selectedGradeId) {
                    loadGradeDetails(selectedGradeId);
                }

                showNotification('Job step deleted successfully!', 'success');
            }
        }
    }

    function updateStats() {
        document.getElementById('totalGrades').textContent = jobGrades.length;
        document.getElementById('totalSteps').textContent = jobSteps.length;
    }

    function filterData() {
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();

        // Filter grades
        const filteredGrades = jobGrades.filter(grade =>
            grade.name.toLowerCase().includes(searchTerm) ||
            grade.code.toLowerCase().includes(searchTerm)
        );

        // Update grade list
        const container = document.getElementById('gradesList');
        const gradeCards = container.querySelectorAll('.border');

        gradeCards.forEach(card => {
            const gradeName = card.querySelector('h4').textContent.toLowerCase();
            const gradeCode = card.querySelector('p').textContent.toLowerCase();

            if (gradeName.includes(searchTerm) || gradeCode.includes(searchTerm)) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });

        // Filter steps table
        const filteredSteps = jobSteps.filter(step => {
            const grade = jobGrades.find(g => g.id === step.gradeId);
            return grade.name.toLowerCase().includes(searchTerm) ||
                   grade.code.toLowerCase().includes(searchTerm) ||
                   step.baseSalary.toString().includes(searchTerm);
        });

        const tbody = document.getElementById('stepsTableBody');
        tbody.innerHTML = '';

        filteredSteps.forEach(step => {
            const grade = jobGrades.find(g => g.id === step.gradeId);
            const row = document.createElement('tr');

            row.innerHTML = `
                <td class="px-4 md:px-6 py-4">
                    <div class="flex items-center space-x-3">
                        <div class="step-level-indicator grade-color-${grade.level}">${grade.level}</div>
                        <div>
                            <span class="font-medium">${grade.name}</span>
                            <p class="text-xs text-gray-500">${grade.code}</p>
                        </div>
                    </div>
                </td>
                <td class="px-4 md:px-6 py-4">
                    <div class="flex items-center space-x-2">
                        <span class="font-bold text-lg">${step.stepLevel}</span>
                        <span class="text-xs text-gray-500">/ 5</span>
                    </div>
                </td>
                <td class="px-4 md:px-6 py-4">
                    <span class="font-bold">$${step.baseSalary.toFixed(2)}</span>
                    <p class="text-xs text-gray-500">Monthly</p>
                </td>
                <td class="px-4 md:px-6 py-4">
                    <span class="font-medium">${step.employees}</span>
                    <p class="text-xs text-gray-500">Employees</p>
                </td>
                <td class="px-4 md:px-6 py-4">
                    <div class="flex space-x-2">
                        <button onclick="editStep(${step.id})" class="p-1 text-gray-400 hover:text-primary-600">
                            <span class="material-icons-round text-sm">edit</span>
                        </button>
                        <button onclick="deleteStep(${step.id})" class="p-1 text-gray-400 hover:text-red-600">
                            <span class="material-icons-round text-sm">delete</span>
                        </button>
                    </div>
                </td>
            `;

            tbody.appendChild(row);
        });
    }

    function exportJobStructure() {
        const data = {
            jobGrades: jobGrades,
            jobSteps: jobSteps,
            exportDate: new Date().toISOString(),
            totalEmployees: 1248
        };

        const dataStr = JSON.stringify(data, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);

        const exportFileDefaultName = `job-structure-${new Date().toISOString().split('T')[0]}.json`;

        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', exportFileDefaultName);
        linkElement.click();

        showNotification('Job structure exported successfully!', 'success');
    }

    function showNotification(message, type = 'info') {
        // Create notification element
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg transition-all duration-300 transform translate-x-full`;

        if (type === 'success') {
            notification.classList.add('bg-green-500', 'text-white');
        } else if (type === 'error') {
            notification.classList.add('bg-red-500', 'text-white');
        } else {
            notification.classList.add('bg-blue-500', 'text-white');
        }

        notification.innerHTML = `
            <div class="flex items-center space-x-3">
                <span class="material-icons-round">${type === 'success' ? 'check_circle' : type === 'error' ? 'error' : 'info'}</span>
                <span>${message}</span>
            </div>
        `;

        document.body.appendChild(notification);

        // Animate in
        setTimeout(() => {
            notification.classList.remove('translate-x-full');
            notification.classList.add('translate-x-0');
        }, 10);

        // Remove after 3 seconds
        setTimeout(() => {
            notification.classList.remove('translate-x-0');
            notification.classList.add('translate-x-full');

            setTimeout(() => {
                document.body.removeChild(notification);
            }, 300);
        }, 3000);
    }

    // Modal Functions
    function openModal(modalId) {
        document.getElementById(modalId).classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function closeModal(modalId) {
        document.getElementById(modalId).classList.remove('active');
        document.body.style.overflow = 'auto';

        // Reset forms
        if (modalId === 'addGradeModal') {
            document.getElementById('addGradeForm').reset();
        } else if (modalId === 'addStepModal') {
            document.getElementById('addStepForm').reset();
        }
    }

    // Close modal when clicking outside
    document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal(this.id);
            }
        });
    });

    // Mobile Sidebar Toggle
    const menuToggle = document.getElementById('menuToggle');
    const mobileOverlay = document.getElementById('mobileOverlay');
    const sidebar = document.querySelector('.sidebar-container');

    menuToggle.addEventListener('click', () => {
        sidebar.classList.toggle('open');
        mobileOverlay.classList.toggle('hidden');
        document.body.style.overflow = sidebar.classList.contains('open') ? 'hidden' : 'auto';
    });

    mobileOverlay.addEventListener('click', () => {
        sidebar.classList.remove('open');
        mobileOverlay.classList.add('hidden');
        document.body.style.overflow = 'auto';
    });

    // Theme Toggle
    function initializeTheme() {
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = themeToggle.querySelector('.material-icons-round');

        themeToggle.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            themeIcon.textContent = isDark ? 'light_mode' : 'dark_mode';
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });

        // Initialize theme
        if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            themeIcon.textContent = 'light_mode';
        }
    }

    // Close sidebar on window resize
    window.addEventListener('resize', () => {
        if (window.innerWidth >= 1024) {
            sidebar.classList.remove('open');
            mobileOverlay.classList.add('hidden');
            document.body.style.overflow = 'auto';
        }
    });

    // Sidebar navigation active state
    document.querySelectorAll('.sidebar-item').forEach(item => {
        if (!item.onclick) {
            item.addEventListener('click', function(e) {
                if (this.getAttribute('href') === '#') {
                    e.preventDefault();
                }

                document.querySelectorAll('.sidebar-item').forEach(nav => {
                    nav.classList.remove('active');
                });

                this.classList.add('active');

                if (window.innerWidth < 1024) {
                    sidebar.classList.remove('open');
                    mobileOverlay.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }
            });
        }
    });
  </script>
</main>
</body>
</html>